<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="icon" href="../../favicon.ico">

    <title>Exploration of Boston Food by MBTA</title>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600,700,300,800' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/chosen.min.css">
    <link rel="stylesheet" href="css/styles.css">
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>
    <script src="https://code.jquery.com/jquery-1.11.2.min.js"></script>
    <script src="http://d3js.org/d3.v3.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.2/js/bootstrap.min.js"></script>
    <script src="http://d3js.org/queue.v1.min.js"></script>
    <script src="js/chosen.jquery.min.js"></script>
    <script src="js/mbta-svg.js"></script>

    <!-- js files for vis code -->
    <script src="js/mbtaVis.js"></script>
    <script src="js/heatmapVis.js"></script>
    <script src="js/scatterVis.js"></script>
    <script src="js/zoomVis.js"></script>

  </head>

  <body>

    <div class="container">
      <div class="header clearfix">
        <nav>
          <ul class="nav nav-pills pull-right">
            <li role="presentation" class="active"><a href="#">Home</a></li>
            <li role="presentation"><a href="#">About</a></li>
            <li role="presentation"><a href="#">Contact</a></li>
          </ul>
        </nav>
        <h3 class="text-muted">Exploring Boston Food by MBTA</h3>
      </div>

    <div class="row">
      <div class="col-lg-9"><!-- 0 0 1947 1825 -->
        <div id="map">
          <svg id="mbta_svg"
             xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 2050 1850"
             enable-background="new 0 0 2050 1850" xml:space="preserve">
             <script>document.write(mbta_svg)</script>
             <g id="circles"></g>                   
          </svg>
        </div>

      </div>
      <div class="col-lg-3" id="rightRail">
      <div id="visOptions">
        <div class="btn-group-sm" role="group" aria-label="...">
          <button type="button" class="btn btn-default" onclick="showMap();">Map</button>
          <button type="button" class="btn btn-default" onclick="showCircles();">Circles</button>
        </div>

        <label>Scale Circles By: </label>
        <select class="chosen" id="mySelectOption" onchange="update_vis()"> <!-- rank() -->
          <option value="none" selected>Stop</option>
          <option value="count">Count</option>
          <option value="average_rating" >Avg. Rating</option>
          <option value="total_reviews" >Tot. Reviews</option>
        </select><br/>

        <label> Line: </label>
        <select class="chosen" id="mySelectLine" onchange="line_display()"> 
          <option value="none"selected>All</option>
          <option value="red">Red</option>
          <option value="green">Green</option>
          <option value="orange" >Orange</option>
          <option value="blue" >Blue</option>
        </select><br/>

        <label> Category: </label>
        <select class="chosen" id="mySelectCat" onchange="update_vis()"> <!-- select_cat() -->
        <script>document.write(cat_options)</script>
        </select>
      </div>
      <div id="detailVis"></div>
      </div>

    <div class="row">
      <div class="col-lg-12">
      <h3>Scatterplot Vis</h3>
      </div>
    </div>

    <div class="row">
      <div class="col-lg-9">
        <div id="scatter">
<!--           <svg width="780" height="650">
              <text x="50" y="50">scatter plot area</text>
          </svg> -->
        </div>

      </div>
        <div class="col-lg-3" id="scatterRail">
        <div id="scatter-zoom">
          <svg width="350" height="350" style="background-color: lightblue">
              <text x="50" y="50">scatter zoom area</text>
          <g id="scatter"> </g>
          </svg>        
        options stuff here
        </div>
      </div>

      <footer class="footer">
        <!-- <p>&copy; Company 2015</p> -->
      </footer>

    </div> <!-- /container -->
  </body>
</html>


<script type="text/javascript">

   // use chosen.js for select widgets
   $(".chosen").chosen()

   //Global Variables
   var metaData;
   var allData;

  // dv = new mbtaVis('#detailVis', allData, metaData);
  // ds = new ScatterVis('#scatter', allData, metaData);


   //check if there is an error, store data in global variables
   var dataLoaded = function (error, _metaData, _allData) {

      if (!error) {

         allData = _allData
         metaData = _metaData

         console.log("metaData", metaData);
         console.log("allData", allData)

         // create a new mbtaVis object
         //initVis();
         mv = new mbtaVis('#detailVis', allData, metaData);
         ds = new ScatterVis('#scatter', allData, metaData);
      }

   }

   //Start the dataload
   var startHere = function(){

       // Load data here and call "dataLoaded" afterwards
       // Hint: http://giscollective.org/d3-queue-js/
       queue()
           .defer(d3.json, '../data/mbta_metadata.json') // AllData
           .defer(d3.json, '../data/data.json') // Contains meta-information about AllData. 
           .await(dataLoaded); // Call dataLoaded function

   }

   startHere()

</script>
</body>
</html>